(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{120:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__webpack_require__(23);exports.useConnectionContext=function(context){return react_1.useContext(context.$__privateReactInternalContext)}},183:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const signalr_1=__webpack_require__(398),createConnectionContext_1=__webpack_require__(188),urlNamespace="https://hw-signalr-counter.azurewebsites.net/";exports.CounterContext=createConnectionContext_1.createConnectionContext(()=>(new signalr_1.HubConnectionBuilder).withUrl(`${urlNamespace}counter`,signalr_1.HttpTransportType.WebSockets).build()),exports.Invalid=createConnectionContext_1.createConnectionContext(()=>(new signalr_1.HubConnectionBuilder).withUrl(`${urlNamespace}counter1`,signalr_1.HttpTransportType.WebSockets).build())},188:function(module,exports,__webpack_require__){"use strict";var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)Object.hasOwnProperty.call(mod,k)&&(result[k]=mod[k]);return result.default=mod,result};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__importStar(__webpack_require__(23)),useConnection_1=__webpack_require__(411),ConnectionContext_1=__webpack_require__(412);var useStream_1=__webpack_require__(189);exports.useStream=useStream_1.useStream,exports.createConnectionContext=(createConnection=>{const context=react_1.createContext({connection:null,error:null}),{Provider:Provider}=context;return new ConnectionContext_1.ConnectionContext(function(props){const connStatus=useConnection_1.useConnection(createConnection);return react_1.default.createElement(Provider,{value:connStatus},props.children)},context)})},189:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__webpack_require__(23),noop=()=>{};function stateReducer(state,action){return Object.assign({},state,action)}exports.useStream=function(stream){const[state,setState]=react_1.useReducer(stateReducer,{error:null,value:null,done:!1});return react_1.useEffect(()=>{if(!stream)return noop;const sub=stream.subscribe({complete:()=>setState({done:!0}),error:err=>setState({error:err,done:!0}),next:streamValue=>setState({value:streamValue})});return()=>{try{sub.dispose()}catch(_){}}},[stream]),state}},213:function(module,exports,__webpack_require__){__webpack_require__(214),__webpack_require__(294),module.exports=__webpack_require__(295)},295:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){__webpack_require__(10),__webpack_require__(7),__webpack_require__(11);var _storybook_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(92),req=__webpack_require__(396);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_3__.configure)(function(){req.keys().forEach(function(filename){return req(filename)})},module)}.call(this,__webpack_require__(296)(module))},396:function(module,exports,__webpack_require__){var map={"./ConnectionStatus.stories.tsx":397,"./ConnectionStream.stories.tsx":413};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=396},397:function(module,exports,__webpack_require__){"use strict";(function(module){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__webpack_require__(92),react_2=__importDefault(__webpack_require__(23)),useConnectionContext_1=__webpack_require__(120),connections_1=__webpack_require__(183),createStatusWithContext=ctx=>()=>{const{connection:connection,error:error}=useConnectionContext_1.useConnectionContext(ctx);return error?react_2.default.createElement(react_2.default.Fragment,null,"Connection error ❌"):connection?react_2.default.createElement(react_2.default.Fragment,null,"Connected ✔"):react_2.default.createElement(react_2.default.Fragment,null,"Connecting...")},SuccessfulStatus=createStatusWithContext(connections_1.CounterContext),FailedStatus=createStatusWithContext(connections_1.Invalid);react_1.storiesOf("Connection status",module).add("Successful connect",()=>react_2.default.createElement(connections_1.CounterContext.Provider,null,react_2.default.createElement("div",null,react_2.default.createElement(SuccessfulStatus,null)))).add("Connection error",()=>react_2.default.createElement(connections_1.Invalid.Provider,null,react_2.default.createElement("div",null,react_2.default.createElement(FailedStatus,null))))}).call(this,__webpack_require__(65)(module))},411:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__webpack_require__(23),reducer=(state,partialState)=>Object.assign({},state,partialState),initialState={connection:null,error:null};exports.useConnection=function(createConnection){const[state,setState]=react_1.useReducer(reducer,initialState);return react_1.useEffect(()=>{const connection=createConnection();return connection.start().then(()=>setState({connection:connection})).catch(error=>setState({error:error})),()=>{connection.stop()}},[createConnection]),state}},412:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.ConnectionContext=class{constructor(AutoProvider,Ctx){this.Provider=AutoProvider,this.Consumer=Ctx.Consumer,this.$__privateReactInternalContext=Ctx}}},413:function(module,exports,__webpack_require__){"use strict";(function(module){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const addon_actions_1=__webpack_require__(414),react_1=__webpack_require__(92),react_2=__importDefault(__webpack_require__(23)),src_1=__webpack_require__(519),connections_1=__webpack_require__(183),effect=addon_actions_1.action("[CounterSubscriber]: Update");function useStreamSubscription(creator,inputs){const stream=src_1.useStreamCreator(connections_1.CounterContext,creator,inputs);return src_1.useStream(stream)}react_1.storiesOf("Connection stream",module).addDecorator(story=>react_2.default.createElement(connections_1.CounterContext.Provider,null,react_2.default.createElement("div",null,story()))).add("subscription",()=>{return react_2.default.createElement(function(props){const streamState=useStreamSubscription(conn=>conn.stream("ObservableCounter",props.count,props.delayInSeconds),[props.count,props.delayInSeconds]),{value:value,error:error,done:done}=streamState;return done?react_2.default.createElement("span",null,value," done ✔"):error?react_2.default.createElement("span",null,"Subscription error ❌"):value||0===value?react_2.default.createElement("span",null,value.toString()):react_2.default.createElement("span",null,"Connecting...")},{count:5,delayInSeconds:1})}).add("subscription w/ side effects",()=>{return react_2.default.createElement(react_2.default.Fragment,null,react_2.default.createElement("p",null,"See the ",react_2.default.createElement("strong",null,"Action Logger")," section for updates"),react_2.default.createElement(function(props){const streamState=useStreamSubscription(conn=>conn.stream("ObservableCounter",props.count,props.delayInSeconds),[props.count,props.delayInSeconds]);return react_2.default.useEffect(()=>{effect(streamState)},[streamState.value,streamState.error,streamState.done]),null},{count:5,delayInSeconds:1}))})}).call(this,__webpack_require__(65)(module))},519:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var useStream_1=__webpack_require__(189);exports.useStream=useStream_1.useStream;var useStreamCreator_1=__webpack_require__(520);exports.useStreamCreator=useStreamCreator_1.useStreamCreator;var useConnectionContext_1=__webpack_require__(120);exports.useConnectionContext=useConnectionContext_1.useConnectionContext;var createConnectionContext_1=__webpack_require__(188);exports.createConnectionContext=createConnectionContext_1.createConnectionContext},520:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const react_1=__webpack_require__(23),useConnectionContext_1=__webpack_require__(120);exports.useStreamCreator=function(context,streamCreator,inputs){const{connection:connection}=useConnectionContext_1.useConnectionContext(context);return react_1.useMemo(()=>connection?streamCreator(connection):null,[connection,...inputs])}}},[[213,1,2]]]);
//# sourceMappingURL=main.b26b655389088e8ae27b.bundle.js.map